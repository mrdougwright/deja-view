<!doctype html>

<html>

<head>
<title>Wizard demo</title>
</head>

<body>

<section class='wizard'>

	<div class='index'>

		<div class='index-stepName'>
			<!--repeat steps-->
			<!--if accessible (append-class accessible)-->
			<!--if current (append-class current)-->
			<span class='index-stepName-text'>
				<!--put this.name-->
			</span>
		</div>
	</div>

	<div class='step' data-name='First'>
		<form>
			<!--on submit advance-->
			<!--on submit (log hi)-->
			<button> Next step </button>
		</form>
	</div>

	<a>
		<!--on click (setAttr data-hi hi) -->
	</a>

	<div class='step' data-name='Second'>
	</div>

	<a>
		<!--on click toggle-donate-wizard-->
		Donate
	</a>

</section>

<div class='modal fade'>
	<!--when toggle-donate-wizard (toggle-class in)-->


a:
	on:
		event: 'click',

	<a>
		<on event='click'>
			<set-attr name='something' val='something-else'>
		</on>

		<= on click <= set-attr @something @something-else >>

		<!-- on click ( jset-attr @something @something-else ) -->

		Close!
	</a>
</div>

	view('when', function(directive, rest) {
		var self = this
		this.on(directive, function() {
			view(rest)
		})
	})


	view('toggle-class', function(class) {
		this.node.className = class
	})

<script>

view.hi = 1

view.set = function(key, val) {
	view[key] = val
	view.emit('change ' + key)
}

view.bind = function(key, fn) {
	view.on('change ' + key, fn)
}

this.emit('change hi')

this.on('change hi', function() {
		// re-evalute the parts of the view that use hi
})

<!-- put length @todos -->

view('length', function(arr) {
		return arr.length
})

view('put', function(key) {
		var self = this
		this.bind(key, function() {
			self.node.textConent = self.doRest()
		})
})

view('toggle-donate-wizard', function() {
		console.log('toggling!')
})

view.steps = $('.step').map(function(el, i) {
		return {
			name: $(el).data('name')
			index: i,
			accessible: false, current: false
	}
})

view.steps[0].accessible = true
view.steps[0].current = true

view('advance', function() {
	var index = this.node.getAttribute('data-index')
	view.steps[index].current = false
	view.steps[index+1].current = true
	view.steps[index+1].accessible = true
	$(this.node).parent().hide()
	$(this.node).parent().next().fadeIn()
})

view('setAttr', function(key, val) {
		this.node.setAttribute(key, val)
})

view('modify', function(key, val) {
		key = 'href'
		val = 'myClass'
		this.node[key] = val
		this.node.href = 'myClass'
})

view('log', function(str) {
	console.log(str)
})
</script>

</body>
</html>
